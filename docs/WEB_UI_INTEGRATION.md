# Webç•Œé¢é›†æˆè¯´æ˜ - ç­–ç•¥ä¼˜åŒ–é—­ç¯

## ğŸ¯ é›†æˆä½ç½®

**ç­–ç•¥ä¼˜åŒ–é—­ç¯** å·²é›†æˆåˆ° **"é«˜çº§åŠŸèƒ½" Tab** ä¸­,ç”¨æˆ·å¯ä»¥é€šè¿‡ç®€å•çš„Webç•Œé¢å®Œæˆæ•´ä¸ªä¼˜åŒ–æµç¨‹ã€‚

---

## ğŸš€ å¿«é€Ÿé›†æˆ (3æ­¥)

### Step 1: åœ¨ `unified_dashboard.py` ä¸­å¯¼å…¥ç»„ä»¶

åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ å¯¼å…¥:

```python
# åœ¨ unified_dashboard.py çº¦ç¬¬200è¡Œå·¦å³æ·»åŠ 
try:
    from web.components.strategy_loop_ui import render_strategy_loop_ui
    STRATEGY_LOOP_AVAILABLE = True
except Exception as e:
    logger.warning(f"ç­–ç•¥ä¼˜åŒ–é—­ç¯UIå¯¼å…¥å¤±è´¥: {e}")
    STRATEGY_LOOP_AVAILABLE = False
```

### Step 2: åœ¨"é«˜çº§åŠŸèƒ½"Tabä¸­æ·»åŠ é—­ç¯å­Tab

åœ¨ `render_phase4_advanced_features()` æ–¹æ³•ä¸­æ·»åŠ :

```python
def render_phase4_advanced_features(self):
    """æ¸²æŸ“ Phase 4 é«˜çº§åŠŸèƒ½"""
    st.header("ğŸš€ é«˜çº§åŠŸèƒ½")
    
    # åŸæœ‰çš„Tabs
    tab1, tab2, tab3, tab4, tab5 = st.tabs([
        "ğŸ”¥ ç­–ç•¥ä¼˜åŒ–é—­ç¯",  # æ–°å¢!
        "ğŸ’¼ æ¨¡æ‹Ÿäº¤æ˜“",
        "ğŸ“Š ç­–ç•¥å›æµ‹",
        "ğŸ¯ æ•°æ®å¯¼å‡º",
        "âš™ï¸ ç³»ç»Ÿè®¾ç½®"
    ])
    
    # æ–°å¢ç­–ç•¥é—­ç¯Tab
    with tab1:
        if STRATEGY_LOOP_AVAILABLE:
            render_strategy_loop_ui()
        else:
            st.error("âŒ ç­–ç•¥ä¼˜åŒ–é—­ç¯æ¨¡å—æœªå®‰è£…")
    
    # åŸæœ‰Tabs...
    with tab2:
        self._render_simulated_trading()
    
    with tab3:
        self._render_backtest()
    # ...
```

### Step 3: è¿è¡ŒDashboard

```bash
cd G:\test\qilin_stack
streamlit run web/unified_dashboard.py
```

ç„¶åè®¿é—® http://localhost:8501,åˆ‡æ¢åˆ° **"é«˜çº§åŠŸèƒ½" â†’ "ç­–ç•¥ä¼˜åŒ–é—­ç¯"**

---

## ğŸ“– ç”¨æˆ·ä½¿ç”¨æµç¨‹

### ç•Œé¢ç»“æ„

```
ğŸ”¥ ç­–ç•¥ä¼˜åŒ–é—­ç¯
â”œâ”€â”€ ğŸš€ å¿«é€Ÿå¼€å§‹
â”‚   â”œâ”€â”€ âš™ï¸ é…ç½®å‚æ•°
â”‚   â”‚   â”œâ”€â”€ ğŸ¤– AIé…ç½® (æ¨¡å‹/API Key)
â”‚   â”‚   â””â”€â”€ ğŸ“Š ä¼˜åŒ–é…ç½® (ä¸»é¢˜/è½®æ•°/ç›®æ ‡)
â”‚   â”œâ”€â”€ ğŸ”§ å›æµ‹é…ç½® (èµ„é‡‘/æ‰‹ç»­è´¹)
â”‚   â”œâ”€â”€ ğŸ“ˆ æ•°æ®å‡†å¤‡ (CSV/ç¤ºä¾‹/AKShare)
â”‚   â””â”€â”€ ğŸš€ å¯åŠ¨æŒ‰é’®
â”‚
â”œâ”€â”€ ğŸ“Š ä¼˜åŒ–ç»“æœ
â”‚   â”œâ”€â”€ ğŸ¯ æœ€ä¼˜ç­–ç•¥è¡¨ç° (æ”¶ç›Š/å¤æ™®/å›æ’¤/å¾—åˆ†)
â”‚   â”œâ”€â”€ ğŸ“ˆ ä¼˜åŒ–å†å² (æ›²çº¿å›¾+è¡¨æ ¼)
â”‚   â”œâ”€â”€ ğŸ† æœ€ä¼˜ç­–ç•¥è¯¦æƒ… (å› å­/æƒé‡)
â”‚   â””â”€â”€ ğŸ“¥ ä¸‹è½½æŠ¥å‘Š
â”‚
â””â”€â”€ ğŸ“– ä½¿ç”¨è¯´æ˜
    â”œâ”€â”€ ä»€ä¹ˆæ˜¯ç­–ç•¥ä¼˜åŒ–é—­ç¯?
    â”œâ”€â”€ å¿«é€Ÿå¼€å§‹ (3æ­¥)
    â”œâ”€â”€ æœ€ä½³å®è·µ
    â”œâ”€â”€ æ—¶é—´é¢„ä¼°
    â””â”€â”€ å¸¸è§é—®é¢˜
```

### æ“ä½œæ­¥éª¤ (ç”¨æˆ·è§†è§’)

**Step 1: é…ç½®å‚æ•°**
1. é€‰æ‹©LLMæ¨¡å‹ (æ¨è: gpt-3.5-turbo)
2. è¾“å…¥API Key
3. è®¾ç½®ä¼˜åŒ–è½®æ•° (æ¨è: 3-5è½®)
4. å¡«å†™ç ”ç©¶ä¸»é¢˜ (å¦‚"å¯»æ‰¾Aè‚¡åŠ¨é‡å› å­")

**Step 2: å‡†å¤‡æ•°æ®**
- é€‰é¡¹A: ä¸Šä¼ CSVæ–‡ä»¶
- é€‰é¡¹B: ä½¿ç”¨ç¤ºä¾‹æ•°æ® (å¿«é€Ÿæµ‹è¯•)
- é€‰é¡¹C: AKShareåœ¨çº¿è·å–

**Step 3: å¯åŠ¨ä¼˜åŒ–**
1. ç‚¹å‡» "ğŸš€ å¯åŠ¨ä¼˜åŒ–é—­ç¯" æŒ‰é’®
2. ç­‰å¾…è¿›åº¦æ¡å®Œæˆ (15-50åˆ†é’Ÿ)
3. è‡ªåŠ¨åˆ‡æ¢åˆ°ç»“æœé¡µ

**Step 4: æŸ¥çœ‹ç»“æœ**
1. åˆ‡æ¢åˆ° "ğŸ“Š ä¼˜åŒ–ç»“æœ" Tab
2. æŸ¥çœ‹æ€§èƒ½æŒ‡æ ‡å’Œä¼˜åŒ–å†å²
3. ä¸‹è½½å®Œæ•´æŠ¥å‘Š

---

## ğŸ¨ ç•Œé¢æˆªå›¾è¯´æ˜

### å¿«é€Ÿå¼€å§‹ç•Œé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”¥ ç­–ç•¥ä¼˜åŒ–é—­ç¯ - AIè‡ªåŠ¨ä¼˜åŒ–                â”‚
â”‚  AIå› å­æŒ–æ˜ â†’ å›æµ‹éªŒè¯ â†’ æ¨¡æ‹Ÿäº¤æ˜“ â†’          â”‚
â”‚  æ€§èƒ½åé¦ˆ â†’ è‡ªåŠ¨ä¼˜åŒ–                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  âš™ï¸ é…ç½®å‚æ•°                    [å±•å¼€ â–¼]    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ ğŸ¤– AIé…ç½®    â”‚ ğŸ“Š ä¼˜åŒ–é…ç½®  â”‚            â”‚
â”‚  â”‚              â”‚              â”‚            â”‚
â”‚  â”‚ LLMæ¨¡å‹:     â”‚ ç ”ç©¶ä¸»é¢˜:    â”‚            â”‚
â”‚  â”‚ [gpt-3.5â–¼]   â”‚ [å¯»æ‰¾Aè‚¡...] â”‚            â”‚
â”‚  â”‚              â”‚              â”‚            â”‚
â”‚  â”‚ API Key:     â”‚ ä¼˜åŒ–è½®æ•°: 5  â”‚            â”‚
â”‚  â”‚ [********]   â”‚ [â”â”â”â—â”â”â”]    â”‚            â”‚
â”‚  â”‚              â”‚              â”‚            â”‚
â”‚  â”‚ AIè¿­ä»£: 3    â”‚ ç›®æ ‡æ”¶ç›Š:15% â”‚            â”‚
â”‚  â”‚ [â”â”â—â”â”â”â”â”]   â”‚ [â”â”â”â”â”â—â”â”]   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                             â”‚
â”‚  ğŸ“ˆ æ•°æ®å‡†å¤‡                                â”‚
â”‚  â—‰ ä¸Šä¼ CSV  â—‹ ä½¿ç”¨ç¤ºä¾‹æ•°æ®  â—‹ AKShare     â”‚
â”‚                                             â”‚
â”‚  â„¹ï¸ ä½¿ç”¨ç¤ºä¾‹æ•°æ® (1461 æ¡)                  â”‚
â”‚                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                             â”‚
â”‚        [   ğŸš€ å¯åŠ¨ä¼˜åŒ–é—­ç¯   ]              â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¼˜åŒ–ç»“æœç•Œé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š ä¼˜åŒ–ç»“æœ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  ### ğŸ¯ æœ€ä¼˜ç­–ç•¥è¡¨ç°                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚å¹´åŒ–æ”¶ç›Šâ”‚å¤æ™®æ¯”ç‡â”‚æœ€å¤§å›æ’¤â”‚ç»¼åˆå¾—åˆ†â”‚        â”‚
â”‚  â”‚ 18.9% â”‚ 1.85  â”‚ 11.8% â”‚ 86.5  â”‚        â”‚
â”‚  â”‚ +6.9% â”‚ +0.65 â”‚       â”‚ /100  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                             â”‚
â”‚  ### ğŸ“ˆ ä¼˜åŒ–å†å²                            â”‚
â”‚  [æ”¶ç›Šæ›²çº¿å›¾ - ä»12%æå‡åˆ°18.9%]            â”‚
â”‚                                             â”‚
â”‚  ### ğŸ† æœ€ä¼˜ç­–ç•¥è¯¦æƒ…                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ å› å­ç»„åˆ     â”‚ ç­–ç•¥å‚æ•°     â”‚            â”‚
â”‚  â”‚              â”‚              â”‚            â”‚
â”‚  â”‚ â€¢ momentum   â”‚ name: AI_... â”‚            â”‚
â”‚  â”‚   IC:0.075   â”‚ top_k: 30    â”‚            â”‚
â”‚  â”‚   æƒé‡:48%   â”‚ stop: -5%    â”‚            â”‚
â”‚  â”‚              â”‚ profit: +15% â”‚            â”‚
â”‚  â”‚ â€¢ reversal   â”‚              â”‚            â”‚
â”‚  â”‚   IC:0.082   â”‚              â”‚            â”‚
â”‚  â”‚   æƒé‡:52%   â”‚              â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                             â”‚
â”‚        [   ğŸ“¥ ä¸‹è½½å®Œæ•´æŠ¥å‘Š   ]              â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ ¸å¿ƒç»„ä»¶

**æ–‡ä»¶**: `web/components/strategy_loop_ui.py`

**ç±»**: `StrategyLoopUI`

**ä¸»è¦æ–¹æ³•**:
- `render()` - ä¸»æ¸²æŸ“æ–¹æ³•
- `_render_quick_start()` - å¿«é€Ÿå¼€å§‹ç•Œé¢
- `_render_results()` - ç»“æœå±•ç¤ºç•Œé¢
- `_render_guide()` - ä½¿ç”¨è¯´æ˜
- `_run_optimization()` - æ‰§è¡Œä¼˜åŒ–

### Session Stateç®¡ç†

```python
st.session_state.loop_running = False     # æ˜¯å¦æ­£åœ¨è¿è¡Œ
st.session_state.loop_results = None      # ä¼˜åŒ–ç»“æœ
st.session_state.loop_history = []        # å†å²è®°å½•
```

### æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥å‚æ•°
    â†“
ç”Ÿæˆé…ç½®å­—å…¸
    â†“
åˆ›å»º StrategyFeedbackLoop
    â†“
è°ƒç”¨ run_full_loop()
    â†“
æ˜¾ç¤ºè¿›åº¦æ¡ + çŠ¶æ€æ–‡æœ¬
    â†“
ä¿å­˜ç»“æœåˆ° session_state
    â†“
æ¸²æŸ“ç»“æœç•Œé¢
```

---

## ğŸ“ é«˜çº§å®šåˆ¶

### 1. è‡ªå®šä¹‰åé¦ˆè§„åˆ™

ä¿®æ”¹ `strategy/strategy_feedback_loop.py`:

```python
def _generate_feedback(self, performance, backtest_result):
    feedback = super()._generate_feedback(performance, backtest_result)
    
    # æ·»åŠ è‡ªå®šä¹‰è§„åˆ™
    if performance.total_trades < 50:
        feedback.append(FeedbackSignal(
            signal_type='negative',
            aspect='activity',
            message='äº¤æ˜“æ¬¡æ•°å¤ªå°‘',
            suggestion='é™ä½é€‰è‚¡é—¨æ§›'
        ))
    
    return feedback
```

### 2. æ·»åŠ æ–°çš„æ•°æ®æº

åœ¨ `_render_quick_start()` ä¸­æ·»åŠ :

```python
elif data_source == 'æ–°æ•°æ®æº':
    # å®ç°æ–°æ•°æ®æºè·å–é€»è¾‘
    data = load_from_new_source()
```

### 3. è‡ªå®šä¹‰UIæ ·å¼

ä½¿ç”¨Streamlitçš„ä¸»é¢˜é…ç½®:

```python
# .streamlit/config.toml
[theme]
primaryColor = "#FF4B4B"
backgroundColor = "#0E1117"
secondaryBackgroundColor = "#262730"
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–

1. **åŠ è½½åŠ¨ç”»** - ä¼˜åŒ–è¿‡ç¨‹æ˜¾ç¤ºè¿›åº¦æ¡å’ŒçŠ¶æ€æ–‡æœ¬
2. **é”™è¯¯å¤„ç†** - å‹å¥½çš„é”™è¯¯æç¤ºå’Œè§£å†³å»ºè®®
3. **ç»“æœå¯è§†åŒ–** - æ›²çº¿å›¾ç›´è§‚å±•ç¤ºä¼˜åŒ–è¿›åº¦
4. **æŠ¥å‘Šä¸‹è½½** - æ”¯æŒJSONæ ¼å¼å®Œæ•´æŠ¥å‘Š

### æ€§èƒ½ä¼˜åŒ–

1. **å¼‚æ­¥å¤„ç†** - é¿å…é˜»å¡UI (å½“å‰ä¸ºç®€åŒ–ç‰ˆ)
2. **ç¼“å­˜ç»“æœ** - ä½¿ç”¨session_stateç¼“å­˜å†å²ç»“æœ
3. **åˆ†é¡µåŠ è½½** - å¤§é‡å†å²æ•°æ®åˆ†é¡µæ˜¾ç¤º

### å®‰å…¨è€ƒè™‘

1. **API Keyä¿æŠ¤** - ä½¿ç”¨passwordç±»å‹è¾“å…¥æ¡†
2. **æ•°æ®éªŒè¯** - æ£€æŸ¥ä¸Šä¼ æ–‡ä»¶æ ¼å¼
3. **èµ„æºé™åˆ¶** - é™åˆ¶ä¼˜åŒ–è½®æ•°å’Œæ•°æ®é‡

---

## ğŸ“ é›†æˆæ£€æŸ¥æ¸…å•

- [ ] å¯¼å…¥ `strategy_loop_ui` ç»„ä»¶
- [ ] åœ¨é«˜çº§åŠŸèƒ½Tabä¸­æ·»åŠ é—­ç¯å­Tab
- [ ] æµ‹è¯•ç¤ºä¾‹æ•°æ®æµç¨‹
- [ ] æµ‹è¯•CSVä¸Šä¼ æµç¨‹
- [ ] æµ‹è¯•AKShareè·å–æµç¨‹
- [ ] éªŒè¯è¿›åº¦æ¡æ˜¾ç¤º
- [ ] æ£€æŸ¥ç»“æœå¯è§†åŒ–
- [ ] æµ‹è¯•æŠ¥å‘Šä¸‹è½½
- [ ] æ£€æŸ¥é”™è¯¯å¤„ç†
- [ ] éªŒè¯ç§»åŠ¨ç«¯é€‚é…

---

## ğŸ› å¸¸è§é—®é¢˜

**Q: å¯åŠ¨æŒ‰é’®æ˜¾ç¤ºç¦ç”¨?**

A: æ£€æŸ¥:
1. æ•°æ®æ˜¯å¦å·²åŠ è½½
2. `loop_running` çŠ¶æ€æ˜¯å¦ä¸º False

**Q: ä¼˜åŒ–ä¸€ç›´ä¸ç»“æŸ?**

A: æ£€æŸ¥:
1. API Keyæ˜¯å¦æœ‰æ•ˆ
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®

**Q: ç»“æœä¸æ˜¾ç¤º?**

A: æ£€æŸ¥:
1. `loop_results` æ˜¯å¦ä¸º None
2. åˆ‡æ¢åˆ°"ä¼˜åŒ–ç»“æœ"Tab
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

---

## ğŸš€ æœªæ¥æ”¹è¿›

- [ ] æ”¯æŒå®æ—¶è¿›åº¦æµå¼æ›´æ–°
- [ ] æ·»åŠ ä¼˜åŒ–å†å²å¯¹æ¯”åŠŸèƒ½
- [ ] æ”¯æŒå¤šç­–ç•¥å¹¶è¡Œä¼˜åŒ–
- [ ] é›†æˆå®ç›˜éƒ¨ç½²æŒ‰é’®
- [ ] æ·»åŠ ç¤¾åŒºç­–ç•¥åˆ†äº«åŠŸèƒ½

---

**é›†æˆå®Œæˆå,ç”¨æˆ·å³å¯é€šè¿‡ç®€å•çš„Webç•Œé¢å®Œæˆå®Œæ•´çš„ç­–ç•¥ä¼˜åŒ–é—­ç¯!** ğŸ‰

**Qilin Stack Team**
**2024-11-08**
