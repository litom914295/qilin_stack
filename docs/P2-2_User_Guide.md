# 实验对比功能 - 用户快速指南

## 🚀 快速开始

### 1. 访问入口

```
主界面 → Qlib量化平台 → 📊 实验管理 → 🔬 实验对比
```

### 2. 使用流程

#### 步骤1: 选择实验
1. 在"📋 实验选择"标签页查看可用实验列表
2. 使用多选框选择2-10个要对比的实验
3. 点击"🔄 加载实验数据"按钮

![实验选择示例](placeholder_select.png)

#### 步骤2: 查看指标对比
1. 切换到"📊 指标对比"标签页
2. 选择对比维度（预测性能/回测收益/风险指标/全部）
3. 查看对比表格，绿色高亮显示最佳值
4. 点击"📥 下载对比表格"保存结果

![指标对比示例](placeholder_metrics.png)

#### 步骤3: 可视化分析
1. 切换到"📈 可视化分析"标签页
2. 从下拉菜单选择图表类型：
   - **指标雷达图**: 多维度直观对比
   - **收益率对比**: 横向柱状图对比收益
   - **IC/ICIR对比**: 预测能力评估
   - **风险指标对比**: 风险控制评估
   - **综合性能对比**: 全局性能概览

![可视化示例](placeholder_viz.png)

#### 步骤4: 统计分析
1. 切换到"🔬 统计分析"标签页
2. 选择分析类型：
   - **统计显著性检验**: 评估性能差异
   - **相关性分析**: 指标间关系热力图
   - **排名和评分**: 自定义权重综合排名
   - **稳定性分析**: 跨实验稳定性评估

![统计分析示例](placeholder_stats.png)

---

## 💡 常见使用场景

### 场景1: 模型选择
**目标**: 选出最佳模型  
**步骤**:
1. 运行多个不同模型的实验（如LightGBM, XGBoost, CatBoost）
2. 使用"综合排名"功能设置权重
3. 查看推荐的最佳模型

**权重建议**:
- IC: 0.3
- ICIR: 0.2
- 年化收益率: 0.3
- 夏普比率: 0.2
- 最大回撤: -0.1 (负向)

### 场景2: 参数调优
**目标**: 找到最优参数组合  
**步骤**:
1. 运行同一模型的多个参数变体
2. 查看"参数差异分析"识别变化的参数
3. 对比性能指标找出最优参数

**关注指标**:
- IC/ICIR（预测能力）
- 夏普比率（风险调整收益）

### 场景3: 特征工程评估
**目标**: 评估不同特征集的效果  
**步骤**:
1. 运行使用不同特征的实验（如Alpha158 vs Alpha360）
2. 使用雷达图全方位对比
3. 权衡性能提升vs计算成本

---

## 📊 指标解读指南

### IC (Information Coefficient)
- **含义**: 预测值与真实收益的相关系数
- **范围**: -1 到 1
- **判断标准**:
  - IC > 0.05: 优秀 🥇
  - IC > 0.03: 良好 ✅
  - IC < 0.03: 一般 ⚠️

### ICIR (IC Information Ratio)
- **含义**: IC的稳定性指标（IC均值/IC标准差）
- **判断标准**:
  - ICIR > 1.0: 优秀 🥇
  - ICIR > 0.5: 良好 ✅
  - ICIR < 0.5: 一般 ⚠️

### 夏普比率 (Sharpe Ratio)
- **含义**: 风险调整后收益
- **判断标准**:
  - Sharpe > 2.0: 优秀 🥇
  - Sharpe > 1.0: 良好 ✅
  - Sharpe < 1.0: 一般 ⚠️

### 最大回撤 (Maximum Drawdown)
- **含义**: 最大峰谷跌幅
- **判断标准**:
  - 回撤 < 10%: 优秀 🥇
  - 回撤 < 20%: 良好 ✅
  - 回撤 > 20%: 需注意 ⚠️

---

## 🎯 最佳实践

### 1. 实验命名规范
```
格式: {模型}_{特征}_{版本}_{日期}

✅ 好例子:
- lgb_alpha158_v1_20241107
- xgb_alpha360_baseline_20241107
- catb_alpha158_tuned_20241107

❌ 坏例子:
- test
- experiment1
- 我的模型
```

### 2. 对比策略

**同模型不同参数**:
- 目的: 参数调优
- 示例: lgb_v1, lgb_v2, lgb_v3
- 关注: 参数差异 + 性能提升

**不同模型同特征**:
- 目的: 模型选择
- 示例: lgb_alpha158, xgb_alpha158, catb_alpha158
- 关注: 综合排名 + 预测能力

**同模型不同特征**:
- 目的: 特征工程
- 示例: lgb_alpha158, lgb_alpha360
- 关注: 性能提升 vs 计算成本

### 3. 结果解读

**看绝对值**:
- IC/ICIR是否达标
- 收益率是否满足预期
- 回撤是否可接受

**看相对值**:
- 哪个模型表现最好
- 性能差距是否显著
- 是否值得切换模型

**看稳定性**:
- ICIR是否够高
- 是否在不同市场环境都表现良好

---

## ⚠️ 注意事项

### 1. 数据要求
- ✅ 至少需要2个实验才能对比
- ✅ 实验需要有MLflow记录
- ✅ 建议选择2-5个实验（最多10个）

### 2. 性能考虑
- 加载大量实验会比较慢（有进度条）
- 首次加载后会缓存数据
- 切换标签页不会重新加载

### 3. 局限性
- **单次运行**: 当前每个实验只有一次运行结果，统计检验功能受限
- **时序数据**: 缺少逐日数据，无法绘制净值曲线
- **解决方案**: 多次运行实验或前往"Qlib回测"查看详细曲线

---

## ❓ 常见问题

### Q1: 为什么找不到我的实验？
**A**: 确保：
1. 实验已在"Qlib工作流"中成功运行
2. MLflow有记录（检查`mlruns/`目录）
3. 点击了"🔄 刷新"按钮

### Q2: 指标对比表格是空的？
**A**: 可能原因：
1. 实验还没有指标记录
2. 选择的对比维度不匹配
3. 尝试选择"全部指标"查看

### Q3: 如何导出对比结果？
**A**: 在"📊 指标对比"标签页点击"📥 下载对比表格"按钮

### Q4: 综合排名的权重如何设置？
**A**: 建议：
- **保守型**: 增加风险指标权重（降低回撤权重到-0.2）
- **激进型**: 增加收益指标权重（收益率0.4）
- **平衡型**: 使用默认权重

### Q5: 能否对比10个以上的实验？
**A**: 技术上可以，但：
- 会影响性能和加载速度
- 图表会变得拥挤难以阅读
- 建议分批对比或筛选重点实验

---

## 🔧 故障排除

### 问题: 加载失败
**错误**: "❌ 加载实验数据失败"

**解决步骤**:
1. 检查Qlib是否正确安装
2. 检查MLflow数据是否完整
3. 查看详细错误信息
4. 联系技术支持

### 问题: 图表显示异常
**现象**: 图表空白或显示错误

**解决步骤**:
1. 刷新页面重试
2. 检查数据是否正常加载
3. 尝试其他图表类型
4. 清除浏览器缓存

### 问题: 性能缓慢
**现象**: 加载或切换标签很慢

**解决步骤**:
1. 减少对比实验数量
2. 关闭其他占用资源的应用
3. 等待首次加载完成（会缓存）
4. 考虑升级硬件

---

## 📚 进阶使用

### 批量对比工作流

**步骤**:
1. 规划实验矩阵（模型×参数×特征）
2. 批量运行所有实验
3. 使用对比功能快速筛选
4. 深入分析top 3模型
5. 生成报告和建议

### 自动化报告

**当前**: 手动查看和截图  
**未来**: 一键生成PDF报告（开发中）

---

## 💬 反馈与支持

**遇到问题?**
1. 查看本指南的"常见问题"部分
2. 查看技术文档 `P2-2_Experiment_Comparison.md`
3. 提交GitHub Issue
4. 联系开发团队

**功能建议?**
- GitHub Discussions
- 内部反馈渠道

---

**版本**: v1.0  
**更新日期**: 2024-11-07  
**作者**: 麒麟量化团队
